<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Updates | Royal Reddy</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="assets/css/style.css" />
</head>
<body>
    <header>
    <nav class="navbar">
      <div class="nav-left">Royal Reddy</div>
      <ul class="nav-right">
        <li><a href="index.html" class="active">Home</a></li>
        <li><a href="updates.html">updates</a></li>
        <li><a href="projects.html">Actions</a></li>
        <li><a href="blogs.html">Blogs</a></li>
        <li><a href="poc.html">PoC</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>   
  </header>
  <h1>ðŸ”„ Latest Updates</h1>
  <ul id="updates"></ul>

<script>
    const username = "royal-reddy-yaparla";  // change if needed
    const updatesList = document.getElementById("updates");

    async function getLatestCommits(username) {
      try {
        // Step 1: Get all public repos (max 100 repos)
        const repoResponse = await fetch(`https://api.github.com/users/${username}/repos?per_page=100`);
        const repos = await repoResponse.json();

        const allCommits = [];

        // Step 2: Fetch the latest commit from each repo
        for (let repo of repos) {
          try {
            const commitRes = await fetch(`https://api.github.com/repos/${username}/${repo.name}/commits?per_page=1`);
            const commitData = await commitRes.json();

            if (commitData[0]) {
              allCommits.push({
                repo: repo.name,
                message: commitData[0].commit.message,
                date: commitData[0].commit.author.date
              });
            }
          } catch (err) {
            console.warn(`Failed to fetch commits for ${repo.name}`);
          }
        }

        // Step 3: Sort commits by date
        allCommits.sort((a, b) => new Date(b.date) - new Date(a.date));

        // Step 4: Display top 10 recent commits
        allCommits.slice(0, 10).forEach(commit => {
          const li = document.createElement("li");
          li.innerHTML = `<strong>ðŸ“¦ ${commit.repo}</strong>: ${commit.message} <br><small>${new Date(commit.date).toLocaleDateString()}</small>`;
          updatesList.appendChild(li);
        });

      } catch (err) {
        updatesList.innerHTML = "<li>Failed to load updates</li>";
        console.error(err);
      }
    }

    getLatestCommits(username);
  </script>

</body>
</html>
